<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>忘记密码</title>
<link type="text/css" href="css/css.css" rel="stylesheet" />
<script type="text/javascript" src="js/jquery.easyui.min.js"></script>
		<script type="text/javascript" src="js/jquery.min.js"></script>
</head>

<body>

	<div class="content">
		<div class="web-width">
			<div class="for-liucheng">
				<div class="liulist for-cur"></div>
				<div class="liulist for-cur"></div>
				<div class="liulist for-cur"></div>
				<div class="liutextbox">
					<div class="liutext for-cur">
						<em>1</em><br />
						<strong>填写手机号</strong>
					</div>
					<div class="liutext for-cur">
						<em>2</em><br />
						<strong>验证身份</strong>
					</div>
					<div class="liutext for-cur">
						<em>3</em><br />
						<strong>设置新密码</strong>
					</div>
				</div>
			</div>
			<!--for-liucheng/-->
			<div class="forget-pwd">
				<dl>
					<dt>手机号：</dt>
					<dd>
						<input id="phone" type="text"  disabled="true"/>
						<div id="phonediv" style="display: flex; font-size: 12px; color: #FF8133;"></div>
					</dd>
					<div class="clears"></div>
				</dl>
				<dl>
					<dt>新密码：</dt>
					<dd>
						<input id="pwd1" type="password" onfocus="pwd1focus()" onblur="pwd1blur()"/>
						<div id="pwd1div" style="display: flex; font-size: 12px; color: #FF8133;"></div>
					</dd>
					<div class="clears"></div>
				</dl>
				<dl>
					<dt>确认密码：</dt>
					<dd>
						<input id="pwd2" type="password" onfocus="pwd2focus()"/>
						<div id="pwd2div" style="display: flex; font-size: 12px; color: #FF8133;"></div>
					</dd>
					<div class="clears"></div>
				</dl>
				<div class="subtijiao">
					<input type="button" value="提交"  onclick="xiugaitijiao()"/>
				</div>
			</div>
			<!--forget-pwd/-->
		</div>
		<!--web-width/-->
	</div>
	<!--content/-->
	
	<script>
	$(function() {
		$.ajax({
			url : "pwd3",
			success : function(date) {
				$("#phone").val(date);
			}
		});
	});
		function xiugaitijiao(){
			var phone = $("#phone").val();
			var pwd1 = $("#pwd1").val();
			var pwd2 = $("#pwd2").val();
			if(phone.length>0){
				if(pwd1.length>0&&pwd2.length>0){
					if (/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/.test(pwd1)) {
						$("#pwd1div").empty();
						$("#pwd2div").empty();
						if(pwd1==pwd2){
							$.ajax({
								url:"forgetselect",
								data:{
									phone:phone,
									pwd:pwd1
								},
								success:function(date){
									if(date>0){
										$("#pwd2div").empty();
										$("#pwd2div").append("明明知道密码，你在跟我玩蛇呢？");
									}else{
										$.ajax({
											url:"forgetupdate",
											data:{
												Phone:phone,
												password:pwd1
											},
											success:function(date){
												if(date>0){
													location.href="login.html";
												}
											}
										});
									}
								}
							});
						}else{
							$("#pwd2div").empty();
							$("#pwd2div").append("新密码与确认密码不相同！");
						}
					} else {
						$("#pwd1div").empty();
						$("#pwd1div").append("密码格式不正确");
					}
				}else{
					$("#pwd1div").empty();
					$("#pwd1div").append("新密码不能为空！");
					$("#pwd2div").empty();
					$("#pwd2div").append("新密码不能为空！");
				}
			}else{
				$("#phonediv").empty();
				$("#phonediv").append("未提交手机号码！！");
			}
		}
		function pwd1focus(){
			$("#pwd1div").empty();
			$("#pwd1div").append("请输入8~16位字符");
		}
		function pwd2focus(){
			$("#pwd2div").empty();
		}
		function pwd1blur(){
			var pwd1 = $("#pwd1").val();
			if (/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{8,16}$/.test(pwd1)) {
				$("#pwd1div").empty();
			} else {
				$("#pwd1div").empty();
				$("#pwd1div").append("密码格式不正确");
			}
		}
		
	</script>
</body>
</html>
